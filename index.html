<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡ßã</title>
    <style>
        /* ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; margin: 0; padding-bottom: 80px; color: #333; }
        .container { max-width: 600px; margin: 0 auto; background-color: #ffffff; min-height: 100vh; box-shadow: 0 0 15px rgba(0,0,0,0.05); }
        
        /* ‡¶π‡ßá‡¶°‡¶æ‡¶∞ */
        .header { background: linear-gradient(135deg, #0088cc, #005f8f); color: white; padding: 25px 20px; text-align: center; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; }
        .header h2 { margin: 0; font-size: 1.6em; }
        .header p { margin: 5px 0 0; opacity: 0.9; font-size: 0.9em; }

        /* ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        .content-section { padding: 20px; display: none; }
        .active-section { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ‡¶Ö‡¶´‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
        .offer-item { background: white; border: 1px solid #eee; border-left: 5px solid #0088cc; border-radius: 8px; padding: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .special-offer { background: linear-gradient(to right, #fff3cd, #fff8e1); border: 1px solid #ffeeba; padding: 15px; margin-top: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }

        /* ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
        .balance-card { background: linear-gradient(135deg, #28a745, #218838); color: white; padding: 25px; border-radius: 15px; text-align: center; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(40,167,69,0.3); }
        .balance-card .balance { font-size: 2.8em; font-weight: bold; margin: 10px 0; }

        /* ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ */
        .referral-box { background-color: #e8f4fd; border: 1px dashed #0088cc; padding: 15px; border-radius: 10px; margin-bottom: 25px; text-align: center; }
        .referral-box input { width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px 0 0 5px; outline: none; }
        .referral-box button { width: 35%; padding: 10px; background-color: #0088cc; color: white; border: none; border-radius: 0 5px 5px 0; cursor: pointer; font-weight: bold; }

        /* ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ì ‡¶á‡¶®‡¶™‡ßÅ‡¶ü */
        .action-buttons { display: flex; gap: 15px; margin-bottom: 30px; }
        .action-buttons button { flex: 1; padding: 15px; font-size: 1em; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; color: white; transition: transform 0.1s; }
        .action-buttons button:active { transform: scale(0.98); }
        .btn-deposit { background-color: #0088cc; box-shadow: 0 4px 10px rgba(0,136,204,0.3); }
        .btn-withdraw { background-color: #dc3545; box-shadow: 0 4px 10px rgba(220,53,69,0.3); }

        .form-section { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-top: 20px; border: 1px solid #eee; display: none; }
        input, select { width: 100%; padding: 12px; margin: 8px 0 15px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1em; }
        .btn-submit { width: 100%; background-color: #0088cc; color: white; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1em; }

        /* ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ */
        .history-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9em; }
        .history-table th { background-color: #f8f9fa; color: #666; padding: 10px; text-align: left; }
        .history-table td { border-bottom: 1px solid #eee; padding: 12px 10px; }
        
        .status-pending { color: #d35400; background: #fadbd8; padding: 3px 8px; border-radius: 15px; font-size: 0.8em; font-weight: bold; }
        .status-approved { color: #27ae60; background: #d4efdf; padding: 3px 8px; border-radius: 15px; font-size: 0.8em; font-weight: bold; }
        .status-rejected { color: #c0392b; background: #f2d7d5; padding: 3px 8px; border-radius: 15px; font-size: 0.8em; font-weight: bold; }

        /* ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ‡¶¨‡¶æ‡¶∞ */
        .nav-bar { display: flex; justify-content: space-around; position: fixed; bottom: 0; left: 0; right: 0; max-width: 600px; margin: 0 auto; background-color: white; border-top: 1px solid #eee; z-index: 100; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .nav-btn { background: none; border: none; padding: 12px; color: #777; cursor: pointer; flex-grow: 1; font-size: 0.9em; }
        .nav-btn.active { color: #0088cc; font-weight: bold; border-top: 3px solid #0088cc; }

        /* ‡¶Æ‡¶°‡¶æ‡¶≤ (‡¶®‡ßã‡¶ü‡¶ø‡¶∂) */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(2px); }
        .modal-content { background: white; padding: 30px; border-radius: 15px; width: 85%; max-width: 400px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .support-button { display: block; width: 100%; text-align: center; background-color: #0088cc; color: white; padding: 15px; border-radius: 10px; text-decoration: none; font-weight: bold; margin-top: 20px; }
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <div id="daily-notice-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 style="color: #0088cc; margin-top:0;">üì¢ ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶®‡ßã‡¶ü‡¶ø‡¶∂</h3>
            <p id="daily-notice-content" style="color:#555; line-height:1.5;">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
            <button onclick="document.getElementById('daily-notice-modal').style.display='none'" style="background: #0088cc; color: white; border: none; padding: 10px 25px; border-radius: 8px; font-weight:bold; margin-top:15px; cursor:pointer;">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h2>‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡ßã</h2>
            <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶∏‡ßç‡¶§ ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶®‡¶æ‡¶∞</p>
        </div>

        <main>
            <div id="offer-section" class="content-section active-section">
                <div class="special-offer">
                    <h3>üî• ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤ ‡¶Ö‡¶´‡¶æ‡¶∞</h3>
                    <p>‡¶°‡¶≤‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü: ‡ßß‡ß©‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ | ‡ßß‡¶Æ ‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü‡ßá ‡ß®‡ß´‡ß¶% ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</p>
                </div>
                <h3 style="color: #444; margin-bottom:15px;">üíé ‡¶≠‡¶ø‡¶Ü‡¶á‡¶™‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú</h3>
                <div class="offer-item"><span style="font-weight:bold">‡ß≥710</span> <span style="color:#28a745; font-weight:bold">‡ß≥2,130 ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</span></div>
                <div class="offer-item"><span style="font-weight:bold">‡ß≥1,020</span> <span style="color:#28a745; font-weight:bold">‡ß≥3,370 ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</span></div>
                <div class="offer-item"><span style="font-weight:bold">‡ß≥1,380</span> <span style="color:#28a745; font-weight:bold">‡ß≥5,390 ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</span></div>
                <div class="offer-item"><span style="font-weight:bold">‡ß≥2,140</span> <span style="color:#28a745; font-weight:bold">‡ß≥10,950 ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</span></div>
                <div class="offer-item"><span style="font-weight:bold">‡ß≥3,290</span> <span style="color:#28a745; font-weight:bold">‡ß≥15,450 ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</span></div>
                <div class="offer-item"><span style="font-weight:bold">‡ß≥5,460</span> <span style="color:#28a745; font-weight:bold">‡ß≥24,250 ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</span></div>
            </div>

            <div id="profile-section" class="content-section">
                <div class="balance-card">
                    <div style="opacity:0.9">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</div>
                    <div class="balance" id="user-balance">‡ß≥0.00</div>
                    <div style="font-size:0.9em; opacity:0.8">ID: <span id="display-uid">...</span></div>
                </div>
                
                <div class="referral-box">
                    <p style="margin-top:0; font-weight:bold; color:#005f8f;">üë• ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶á‡¶®‡¶≠‡¶æ‡¶á‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    <div style="display: flex; justify-content: center;">
                        <input type="text" id="my-ref-link" value="‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá..." readonly>
                        <button onclick="copyRefLink()">‡¶ï‡¶™‡¶ø</button>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-deposit" onclick="showForm('deposit-form')">‚¨áÔ∏è ‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü</button>
                    <button class="btn-withdraw" onclick="showForm('withdraw-form')">‚¨ÜÔ∏è ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</button>
                </div>
                
                <div id="deposit-form" class="form-section">
                    <h3 style="text-align:center; color:#0088cc; margin-top:0;">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</h3>
                    <form id="deposit-form-element">
                        <label>‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶°:</label>
                        <select id="deposit-method" onchange="showPaymentNumber()" required>
                            <option value="">-- ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® --</option>
                            <option value="bkash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ (bKash)</option>
                            <option value="nagad">‡¶®‡¶ó‡¶¶ (Nagad)</option>
                        </select>
                        
                        <div id="payment-number-info" style="background:#e3f2fd; padding:15px; display:none; border-radius:8px; text-align:center; margin-bottom:15px; border:1px solid #bbdefb;">
                            <p style="margin:0; font-size:0.9em;">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡ßá Send Money ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
                            <strong id="payment-number" style="font-size:1.4em; color:#005f8f; display:block; margin:5px 0;">...</strong>
                            <small style="color:red;">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶™‡¶∞ TrxID ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</small>
                        </div>

                        <label>‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®:</label>
                        <select id="deposit-offer" required>
                            <option value="">-- ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® --</option>
                            <option value="offer_710" data-amount="710" data-bonus="2130">710 ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶™‡¶æ‡¶¨‡ßá‡¶® 2,130)</option>
                            <option value="offer_1020" data-amount="1020" data-bonus="3370">1,020 ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶™‡¶æ‡¶¨‡ßá‡¶® 3,370)</option>
                            <option value="offer_1380" data-amount="1380" data-bonus="5390">1,380 ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶™‡¶æ‡¶¨‡ßá‡¶® 5,390)</option>
                            <option value="offer_2140" data-amount="2140" data-bonus="10950">2,140 ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶™‡¶æ‡¶¨‡ßá‡¶® 10,950)</option>
                            <option value="offer_5460" data-amount="5460" data-bonus="24250">5,460 ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶™‡¶æ‡¶¨‡ßá‡¶® 24,250)</option>
                        </select>

                        <label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡¶ü‡¶æ‡¶ï‡¶æ):</label>
                        <input id="deposit-amount" type="number" placeholder="‡¶ï‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá‡¶õ‡ßá‡¶®?" required>
                        
                        <label>TrxID (‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø):</label>
                        <input id="deposit-trxid" type="text" placeholder="TrxID ‡¶¨‡¶∏‡¶æ‡¶®" required>
                        
                        <button type="submit" class="btn-submit">‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                    </form>
                </div>

                <div id="withdraw-form" class="form-section">
                    <h3 style="text-align:center; color:#dc3545; margin-top:0;">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
                    <form id="withdraw-form-element">
                        <label>‡¶ï‡ßã‡¶•‡¶æ‡ßü ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶®‡¶ø‡¶¨‡ßá‡¶®?</label>
                        <select id="withdraw-method" required>
                            <option value="bkash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂</option>
                            <option value="nagad">‡¶®‡¶ó‡¶¶</option>
                        </select>

                        <label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</label>
                        <input id="withdraw-amount" type="number" placeholder="‡¶ï‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡¶¨‡ßá‡¶®?" required>
                        
                        <label>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</label>
                        <input id="withdraw-number" type="number" placeholder="017..." required>
                        
                        <button type="submit" class="btn-submit" style="background-color:#dc3545;">‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                    </form>
                </div>

                <div style="margin-top:30px; display:flex; justify-content:space-between; align-items:center;">
                    <h4 style="margin:0;">üìã ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø</h4>
                    <button onclick="loadHistory()" style="font-size:0.8em; padding:5px 10px; background:#eee; border:none; border-radius:5px; cursor:pointer;">üîÑ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂</button>
                </div>
                <div id="history-content"></div>
            </div>

            <div id="rules-section" class="content-section">
                <h3>üìú ‡¶®‡¶ø‡ßü‡¶Æ‡¶æ‡¶¨‡¶≤‡ßÄ</h3>
                <div id="rules-content" style="background: white; padding: 20px; border-radius: 10px; line-height:1.6; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
                <a href="https://t.me/Imran3612n" target="_blank" class="support-button">üí¨ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡ßÅ‡¶®</a>
            </div>
        </main>
    </div>

    <nav class="nav-bar">
        <button class="nav-btn active" onclick="showSection('offer-section', this)">üéÅ ‡¶Ö‡¶´‡¶æ‡¶∞</button>
        <button class="nav-btn" onclick="showSection('profile-section', this)">üë§ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</button>
        <button class="nav-btn" onclick="showSection('rules-section', this)">üìú ‡¶®‡¶ø‡ßü‡¶Æ</button> 
    </nav>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script> 

    <script>
        // Firebase Config (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶∞)
        const firebaseConfig = {
          apiKey: "AIzaSyCF9cqEoQwPow2VbB0Koj1yyy4QMDofPQE",
          authDomain: "investmentwebsite1.firebaseapp.com",
          databaseURL: "https://investmentwebsite1-default-rtdb.firebaseio.com", 
          projectId: "investmentwebsite1",
          storageBucket: "investmentwebsite1.firebasestorage.app",
          messagingSenderId: "592540774650",
          appId: "1:592540774650:web:1ad31bf96cbc8c60db1943",
          measurementId: "G-QLTC23GYRE"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let USER_ID = 'user_' + Math.floor(Math.random() * 100000);
        let USER_NAME = 'Guest';

        // ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶•‡ßá‡¶ï‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶®‡ßá‡¶ì‡ßü‡¶æ
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            const user = window.Telegram.WebApp.initDataUnsafe.user;
            if (user) { USER_ID = user.id.toString(); USER_NAME = user.first_name; }
        }
        // ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ (‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
        const storedId = localStorage.getItem('site_user_id');
        if(storedId && !window.Telegram.WebApp.initDataUnsafe.user) USER_ID = storedId;
        else localStorage.setItem('site_user_id', USER_ID);
        
        document.getElementById('display-uid').innerText = USER_ID;

        // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶≤‡¶ú‡¶ø‡¶ï
        const urlParams = new URLSearchParams(window.location.search);
        const refParam = urlParams.get('ref');
        if(refParam && refParam !== USER_ID) localStorage.setItem('referredBy', refParam);

        function generateRefLink() {
            const link = window.location.origin + window.location.pathname + "?ref=" + USER_ID;
            document.getElementById('my-ref-link').value = link;
        }
        generateRefLink();

        function copyRefLink() {
            const copyText = document.getElementById("my-ref-link");
            copyText.select(); copyText.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(copyText.value).then(()=>alert("‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!"));
        }

        // =================================================
        // üî• ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶°: ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ì ‡¶Ü‡¶á‡¶™‡¶ø ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç (‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
        // =================================================
        async function trackUserLocation() {
            try {
                // ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶∂‡¶æ‡¶≤‡ßÄ API ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ (ipapi.co)
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                
                const ip = data.ip || 'Unknown';
                const location = (data.city || 'Unknown') + ', ' + (data.country_name || 'Unknown');

                // ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü (Force Update)
                // ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ñ‡ßÅ‡¶≤‡¶≤‡ßá‡¶á ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶¨‡ßá
                db.ref('users/' + USER_ID).update({
                    ip: ip,
                    location: location,
                    last_active: new Date().toISOString()
                });

            } catch (e) { 
                console.error("IP Track Error:", e);
                // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ API (‡¶Ø‡¶¶‡¶ø ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶ü‡¶æ ‡¶´‡ßá‡¶á‡¶≤ ‡¶ï‡¶∞‡ßá)
                try {
                    const res2 = await fetch('https://ipwho.is/');
                    const data2 = await res2.json();
                    db.ref('users/' + USER_ID).update({
                        ip: data2.ip,
                        location: `${data2.city}, ${data2.country}`
                    });
                } catch(err){}
            }
        }
        trackUserLocation(); // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶≤‡ßá‡¶á ‡¶ï‡¶≤ ‡¶π‡¶¨‡ßá

        // =================================================
        // üî• ‡¶∞‡¶ø‡ßü‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶è‡¶¨‡¶Ç ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        // =================================================
        
        // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞ (‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ö‡ßá‡¶û‡ßç‡¶ú ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá ‡¶¨‡¶¶‡¶≤‡¶æ‡¶¨‡ßá)
        db.ref('users/' + USER_ID + '/balance').on('value', s => {
            const bal = s.val() || 0;
            document.getElementById('user-balance').innerText = '‡ß≥' + bal;
        });

        // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ (‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞)
        db.ref('users/' + USER_ID).once('value', s => {
            if(!s.exists()) {
                const referrer = localStorage.getItem('referredBy') || null;
                db.ref('users/' + USER_ID).set({
                    name: USER_NAME, balance: 0, joined: new Date().toISOString(), referredBy: referrer
                });
                trackUserLocation();
            }
        });

        // ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶≤‡ßã‡¶° ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function loadHistory() {
            const historyDiv = document.getElementById('history-content');
            historyDiv.innerHTML = '<p style="text-align:center; color:#888;">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</p>';
            
            let list = [];
            
            // ‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶®‡¶æ
            db.ref('deposits').orderByChild('userId').equalTo(USER_ID).limitToLast(10).once('value', ds => {
                ds.forEach(d => list.push({...d.val(), type: 'Deposit'}));
                
                db.ref('withdrawals').orderByChild('userId').equalTo(USER_ID).limitToLast(10).once('value', ws => {
                    ws.forEach(w => list.push({...w.val(), type: 'Withdraw'}));
                    
                    // ‡¶∏‡¶Æ‡ßü ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã (‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶ó‡ßá)
                    list.sort((a,b) => new Date(b.timestamp) - new Date(a.timestamp));
                    
                    if(list.length === 0) {
                        historyDiv.innerHTML = '<p style="text-align:center; color:#aaa; margin-top:20px;">‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶®‡ßá‡¶á</p>';
                    } else {
                        let html = '<table class="history-table"><thead><tr><th>‡¶ß‡¶∞‡¶®</th><th>‡¶ü‡¶æ‡¶ï‡¶æ</th><th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th></tr></thead><tbody>';
                        let rows = '';
                        list.forEach(item => {
                            let cls = item.status === 'pending' ? 'status-pending' : item.status === 'approved' ? 'status-approved' : 'status-rejected';
                            let statusText = item.status === 'pending' ? 'Pending' : item.status === 'approved' ? 'Success' : 'Rejected';
                            let icon = item.type === 'Deposit' ? '‚¨áÔ∏è ‡¶ú‡¶Æ‡¶æ' : '‚¨ÜÔ∏è ‡¶§‡ßã‡¶≤‡¶æ';
                            let refInfo = item.trxId ? `<br><small style="color:#888;">Trx: ${item.trxId}</small>` : `<br><small style="color:#888;">${item.method}</small>`;
                            
                            rows += `<tr>
                                <td>${icon} ${refInfo}</td>
                                <td style="font-weight:bold;">‡ß≥${item.amount}</td>
                                <td><span class="${cls}">${statusText}</span></td>
                            </tr>`;
                        });
                        historyDiv.innerHTML = html + rows + '</tbody></table>';
                    }
                });
            });
        }
        // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶≤‡ßã‡¶°
        loadHistory();
        
        // ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ (‡¶Ø‡¶ñ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ö‡ßá‡¶û‡ßç‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá)
        db.ref('deposits').on('child_changed', loadHistory);
        db.ref('withdrawals').on('child_changed', loadHistory);

        // =================================================
        //             ‡¶´‡¶∞‡ßç‡¶Æ ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶ø‡¶Ç (‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü/‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞)
        // =================================================

        // ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶≤‡ßã‡¶° (‡¶®‡ßã‡¶ü‡¶ø‡¶∂, ‡¶∞‡ßÅ‡¶≤‡¶∏, ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞)
        db.ref('settings/notice').on('value', s => {
            if(s.exists() && s.val().text) {
                document.getElementById('daily-notice-content').innerText = s.val().text;
                document.getElementById('daily-notice-modal').style.display = 'flex';
            }
        });
        db.ref('settings/rules').on('value', s => document.getElementById('rules-content').innerText = s.val()?.text || "‡¶®‡¶ø‡ßü‡¶Æ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡¶®‡¶ø");
        let adminNumbers = {};
        db.ref('settings/paymentNumbers').on('value', s => { if(s.exists()) adminNumbers = s.val(); });

        function showPaymentNumber() {
            const method = document.getElementById('deposit-method').value;
            if(method && adminNumbers[method]) {
                document.getElementById('payment-number').innerText = adminNumbers[method];
                document.getElementById('payment-number-info').style.display = 'block';
            } else document.getElementById('payment-number-info').style.display = 'none';
        }

        // ‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü
        document.getElementById('deposit-form-element').addEventListener('submit', e => {
            e.preventDefault();
            const btn = e.target.querySelector('button'); 
            btn.disabled = true; btn.innerText = '‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

            const offer = document.getElementById('deposit-offer');
            const selected = offer.options[offer.selectedIndex];
            const amount = parseFloat(document.getElementById('deposit-amount').value);
            
            if(amount !== parseFloat(selected.getAttribute('data-amount'))) {
                alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!'); 
                btn.disabled = false; btn.innerText = '‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®'; return;
            }

            db.ref('deposits').push({
                userId: USER_ID, userName: USER_NAME, 
                amount: amount, bonus: parseFloat(selected.getAttribute('data-bonus')),
                method: document.getElementById('deposit-method').value, 
                trxId: document.getElementById('deposit-trxid').value,
                status: 'pending', timestamp: new Date().toISOString()
            }).then(() => {
                alert('‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤! ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶è‡¶° ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶¨‡ßá‡•§');
                e.target.reset(); showForm(null); 
                btn.disabled = false; btn.innerText = '‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®';
                loadHistory(); // ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂
            });
        });

        // ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü
        document.getElementById('withdraw-form-element').addEventListener('submit', e => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const amount = parseFloat(document.getElementById('withdraw-amount').value);
            
            db.ref('users/'+USER_ID+'/balance').once('value', s => {
                if((s.val()||0) < amount) { 
                    alert('‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á!'); 
                    return; 
                }
                
                btn.disabled = true; btn.innerText = '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...';
                
                db.ref('withdrawals').push({
                    userId: USER_ID, userName: USER_NAME, amount: amount,
                    method: document.getElementById('withdraw-method').value, 
                    number: document.getElementById('withdraw-number').value,
                    status: 'pending', timestamp: new Date().toISOString()
                }).then(() => {
                    alert('‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
                    e.target.reset(); showForm(null); 
                    btn.disabled = false; btn.innerText = '‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®';
                    loadHistory();
                });
            });
        });

        // UI ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤
        function showSection(id, btn) {
            document.querySelectorAll('.content-section').forEach(e => e.classList.remove('active-section'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.form-section').forEach(f => f.style.display = 'none');
            document.getElementById(id).classList.add('active-section');
            btn.classList.add('active');
        }
        function showForm(id) {
            document.querySelectorAll('.form-section').forEach(f => f.style.display = 'none');
            if(id) document.getElementById(id).style.display = 'block';
        }
    </script>
</body>
</html>
